launch:
  # ---------------- 1. 参数定义 ----------------
  - arg: {name: dataset_name, default: 'jackal_real'}
  - arg: {name: use_gt_semantics, default: 'false'}
  - arg: {name: use_openset_places, default: 'false'}
  - arg: {name: labelspace, default: tesse_ade20k} 
  - arg: {name: log_prefix, default: $(var dataset_name)}
  - arg: {name: label_remap_path, default: $(find-pkg-share hydra)/config/label_remaps/uhumans2_office.yaml}

  # ---------------- 2. 图像解压 ----------------
  # 将压缩的 RGB 图像解压为 Raw 图像
  - node:
      pkg: image_transport
      exec: republish
      args: compressed raw
      remap:
        - {from: in/compressed, to: /acl_jackal2/forward/color/image_raw/compressed}
        - {from: out, to: /acl_jackal2/forward/color/image_raw}

  # ---------------- 3. Topic Remappings ----------------
  # 深度图
  - set_remap: {from: hydra/input/left_cam/depth_registered/image_rect, to: /acl_jackal2/forward/depth/image_rect_raw}
  
  # RGB 图 (连到解压出的 Raw)
  - set_remap: {from: hydra/input/left_cam/rgb/image_raw, to: /acl_jackal2/forward/color/image_raw}
  
  # 相机内参
  - set_remap: {from: hydra/input/left_cam/rgb/camera_info, to: /acl_jackal2/forward/color/camera_info}
  
  # 语义分割 (来自推理节点)
  - set_remap: {from: hydra/input/left_cam/semantic/image_raw, to: /semantic_inference/semantic/image_raw}

  # ---------------- 4. 语义推理节点 ----------------
  - group:
      - push_ros_namespace: {namespace: semantic_inference}
      - set_remap: {from: color/image_raw, to: /acl_jackal2/forward/color/image_raw}
      - set_remap: {from: color/camera_info, to: /acl_jackal2/forward/color/camera_info}
      - include:
          if: $(not $(var use_gt_semantics))
          file: $(find-pkg-share semantic_inference_ros)/launch/closed_set.launch.yaml
          arg:
            - {name: labelspace_name, value: $(var labelspace)}
            - {name: model_id, value: '1'}

  # ---------------- 5. Hydra 主程序 ----------------
  - include:
      file: $(find-pkg-share hydra_ros)/launch/hydra.launch.yaml
      arg:
        # [修改点] 指向我们刚创建的 jackal.yaml
        - {name: dataset, value: jackal}
        
        - {name: labelspace, value: $(var labelspace)}
        - {name: log_prefix, value: $(var log_prefix)}
        
        # 这些 Frame 参数依然保留，作为双重保险
        - {name: sensor_frame, value: acl_jackal2/forward_color_optical_frame}
        - {name: robot_frame, value: acl_jackal2/base_link}
        - {name: odom_frame, value: acl_jackal2/odom}
        - {name: map_frame, value: map}
        
        - {name: lcd_config_path, value: $(find-pkg-share hydra)/config/lcd/uhumans2.yaml}
        
        # [修改点] 这里改回空的即可，因为 jackal.yaml 里已经写对了
        - {name: extra_yaml, value: '{}'}